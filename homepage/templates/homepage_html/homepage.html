<!-- Extend the base template -->
{% extends 'global_templates/base.html' %}

<!-- Load static files tag -->
{% load static %}

<!-- 添加 CSRF token 到页面顶部 -->
{% csrf_token %}

<!-- Set the title of the page to "10 OF THE HIGHEST PAYING AFFILIATE PROGRAMS 2024" -->
{% block title %} BeginMama: Top Choice for New Moms - Essentials from Maternity to Baby Care {% endblock %}

<!-- Start the content block -->
{% block content %}

<!-- Header section -->
<header>
    <nav>
        <!-- Logo section -->
        <div class="logo">
            <!-- Company logo image -->
            <img src="{% static 'images/BeginMamaLogo.png' %}" alt="BeginMama Logo" class="logo-image">
            <!-- Company name/logo text, linked to homepage -->
            <a id="logo-text" href="{% url 'homepage:homepage' %}"><span class="logo-text">BeginMama</span></a>
        </div>

        <!-- Theme mode switcher -->
        {% include 'global_templates/theme_switcher.html' %}

        <!-- Navigation links -->
        <ul class="nav-links">
            <li><a href="#home">Home</a></li>
            <li><a href="#products">Products</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#reviews-blogs">Reviews & Blogs</a></li>
            <li><a href="#contact">Contact</a></li>
        </ul>

        <!-- Burger menu for mobile view -->
        <div class="burger">
            <div class="line1"></div>
            <div class="line2"></div>
            <div class="line3"></div>
        </div>
    </nav>
</header>


 <!-- Hero Section -->
<section id="home" class="hero">
    <!-- Content of the hero section -->
    <div class="hero-content">
        <!-- Main heading of the hero section -->
        <h1>Begin Your Best Mama Moments with Us</h1>
        <!-- Subheading of the hero section -->
        <p>Welcome to BeginMama's curated collection of must-have baby essentials! We're here to help you prepare for your beautiful journey into motherhood.</p>
        <div class="hero-features">
            <ul>
                <li>Track your baby preparation progress with our smart checklist system</li>
                <li>Find the best baby products recommended by experienced moms</li>
                <li>Easily manage and track your purchased items</li>
                <li>Get everything you need for your baby's arrival</li>
            </ul>
        </div>
        <!-- Call-to-action button -->
        <a href="#featured-products" class="cta-button">Let's Begin Your Journey</a>
    </div>
</section> 

<!-- Featured Products Section -->
<section id="featured-products" class="latest-software">
    <!-- Heading for the featured products section -->
    <h2>Top Picks for New Moms</h2>
    <!-- Grid container for featured products -->
    <div class="software-grid">
        <!-- Baby Clothes -->
        {% for item in featured_products.baby_clothes %}
        <div class="software-card" id="card-bc-{{item.id}}">
            <img class="software-image" src="{{item.image.url}}" alt="Baby Clothes Image">
            <h3 class="software-title">{{item.title}}</h3>
            {% if item.price %}
            <span class="software-price">{{item.price}}</span>
            {% endif %}
            <p class="software-description">{{item.description}}</p>
            <a href="{{item.affiliate_link}}" 
               class="software-affiliate-link"
               onclick="markAsCompleted(event, 'card-bc-{{item.id}}')">
                Add to My Checklist
            </a>
        </div>
        {% endfor %}

        <!-- Toiletries -->
        {% for item in featured_products.toiletries %}
        <div class="software-card" id="card-tl-{{item.id}}">
            <img class="software-image" src="{{item.image.url}}" alt="Product Image">
            <h3 class="software-title">{{item.title}}</h3>
            {% if item.price %}
            <span class="software-price">{{item.price}}</span>
            {% endif %}
            <p class="software-description">{{item.description}}</p>
            <a href="{{item.affiliate_link}}" 
               class="software-affiliate-link"
               onclick="markAsCompleted(event, 'card-tl-{{item.id}}')">
                Add to My Checklist
            </a>
        </div>
        {% endfor %}

        <!-- Sleep Essentials -->
        {% for item in featured_products.sleep_essentials %}
        <div class="software-card" id="card-se-{{item.id}}">
            <img class="software-image" src="{{item.image.url}}" alt="Product Image">
            <h3 class="software-title">{{item.title}}</h3>
            {% if item.price %}
            <span class="software-price">{{item.price}}</span>
            {% endif %}
            <p class="software-description">{{item.description}}</p>
            <a href="{{item.affiliate_link}}" 
               class="software-affiliate-link"
               onclick="markAsCompleted(event, 'card-se-{{item.id}}')">
                Add to My Checklist
            </a>
        </div>
        {% endfor %}

        <!-- Daily Essentials -->
        {% for item in featured_products.daily_essentials %}
        <div class="software-card" id="card-de-{{item.id}}">
            <img class="software-image" src="{{item.image.url}}" alt="Product Image">
            <h3 class="software-title">{{item.title}}</h3>
            {% if item.price %}
            <span class="software-price">{{item.price}}</span>
            {% endif %}
            <p class="software-description">{{item.description}}</p>
            <a href="{{item.affiliate_link}}" 
               class="software-affiliate-link"
               onclick="markAsCompleted(event, 'card-de-{{item.id}}')">
                Add to My Checklist
            </a>
        </div>
        {% endfor %}

        <!-- Feeding Supplies -->
        {% for item in featured_products.feeding_supplies %}
        <div class="software-card" id="card-fs-{{item.id}}">
            <img class="software-image" src="{{item.image.url}}" alt="Product Image">
            <h3 class="software-title">{{item.title}}</h3>
            {% if item.price %}
            <span class="software-price">{{item.price}}</span>
            {% endif %}
            <p class="software-description">{{item.description}}</p>
            <a href="{{item.affiliate_link}}" 
               class="software-affiliate-link"
               onclick="markAsCompleted(event, 'card-fs-{{item.id}}')">
                Add to My Checklist
            </a>
        </div>
        {% endfor %}

        <!-- Large Items -->
        {% for item in featured_products.large_items %}
        <div class="software-card" id="card-li-{{item.id}}">
            <img class="software-image" src="{{item.image.url}}" alt="Product Image">
            <h3 class="software-title">{{item.title}}</h3>
            {% if item.price %}
            <span class="software-price">{{item.price}}</span>
            {% endif %}
            <p class="software-description">{{item.description}}</p>
            <a href="{{item.affiliate_link}}" 
               class="software-affiliate-link"
               onclick="markAsCompleted(event, 'card-li-{{item.id}}')">
                Add to My Checklist
            </a>
        </div>
        {% endfor %}
    </div>
</section>

<script>
function getCookie(name) {
    const value = `; ${document.cookie}`;
    const parts = value.split(`; ${name}=`);
    if (parts.length === 2) return parts.pop().split(';').shift();
}

function markAsCompleted(event, cardId) {
    event.preventDefault();
    
    const card = document.getElementById(cardId);
    const button = card.querySelector('.software-affiliate-link');
    // 从 cardId 中提取产品类型和ID
    const [, type, id] = cardId.split('-');  // 例如 'card-bc-1' 会得到 ['card', 'bc', '1']
    const productId = `${type}-${id}`;  // 组合成 'bc-1' 这样的格式
    const isCompleted = card.classList.contains('completed');
    
    // 直接从页面获取 CSRF token
    const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
    
    // 创建 FormData 对象
    const formData = new FormData();
    formData.append('product_id', productId);
    formData.append('action', isCompleted ? 'cancel' : 'complete');
    
    // 发送请求到服务器
    fetch('{% url "homepage:mark_completed" %}', {
        method: 'POST',
        headers: {
            'X-CSRFToken': csrftoken,
        },
        credentials: 'same-origin',
        body: formData,
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(data => {
        if (data.status === 'success') {
            if (isCompleted) {
                // 取消完成状态
                card.classList.remove('completed');
                button.textContent = 'Add to My Checklist';
            } else {
                // 添加完成状态
                card.classList.add('completed');
                button.textContent = 'Remove from Checklist';
                window.open(button.href, '_blank');
            }
        }
    })
    .catch(error => {
        console.error('Error:', error);
    });
}

// 页面加载时检查 cookies 恢复完成状态
document.addEventListener('DOMContentLoaded', function() {
    const cards = document.querySelectorAll('.software-card');
    cards.forEach(card => {
        const [, type, id] = card.id.split('-');
        const productId = `${type}-${id}`;
        const cookieName = `completed_product_${productId}`;
        if (getCookie(cookieName) === 'true') {
            card.classList.add('completed');
            const button = card.querySelector('.software-affiliate-link');
            button.textContent = 'Remove from Checklist';
        }
    });
});
</script>

<!-- Products Section -->
<section id="products" class="products">
    <!-- Heading for the products section -->
    <h2>Our Curated Selection</h2>
    <!-- Grid container for product categories -->
    <div class="product-grid">
        <!-- Product card for Baby Sleep Essentials -->
        <div class="product-card">
            <!-- Icon representing baby sleep essentials -->
            <i class="fas fa-bed"></i>
            <!-- Product category title -->
            <h3>Baby Sleep Essentials</h3>
            <!-- Description of the product category -->
            <p>Essential products for every need</p>
            <!-- Link to the baby sleep essentials products page -->
            <a href="{% url 'sleep_essentials:sleep_essentials' %}" class="find-product">Find Baby Sleep Essentials</a>
        </div>
        <!-- Product card for  Daily Baby Essentials-->
        <div class="product-card">
            <!-- Icon representing daily essentials -->
            <i class="fas fa-box"></i>
            <!-- Product category title -->
            <h3>Daily Baby Essentials</h3>
            <!-- Description of the product category -->
            <p>Essential products for every need</p>
            <!-- Link to the daily essentials products page -->
            <a href="{% url 'daily_essentials:daily_essentials' %}" class="find-product">Find Daily Essentials</a>
        </div>
        <!-- Product card for Large Items -->
        <div class="product-card">
            <!-- Icon representing large items -->
            <i class="fas fa-dolly"></i>
            <!-- Product category title -->
            <h3>Large Baby Items</h3>
            <!-- Description of the product category -->
            <p>Cribs, strollers, and other large essentials</p>
            <!-- Link to the large items products page -->
            <a href="{% url 'large_items:large_items' %}" class="find-product">Find Large Items</a>
        </div> 
        <!-- Product card for Feeding Supplies -->
        <div class="product-card">
            <!-- Icon representing feeding supplies -->
            <i class="fas fa-baby-carriage"></i>
            <!-- Product category title -->
            <h3>Feeding Supplies</h3>
            <!-- Description of the product category -->
            <p>Essential feeding supplies for your baby</p>
            <!-- Link to the feeding supplies products page -->
            <a href="{% url 'feeding_supplies:feeding_supplies' %}" class="find-product">Find Feeding Supplies</a>
        </div>
        <!-- Product card for Baby Clothes -->
        <div class="product-card">
            <!-- Icon representing baby clothes -->
            <i class="fas fa-baby"></i>
            <!-- Product category title -->
            <h3>Baby Clothes</h3>
            <!-- Description of the product category -->
            <p>Comfortable and stylish baby wear</p>
            <!-- Link to the baby clothes products page -->
            <a href="{% url 'baby_clothes:baby_clothes' %}" class="find-product">Find Baby Clothes</a>
        </div>
        <!-- Product card for Toiletries -->
        <div class="product-card">
            <!-- Icon representing toiletries -->
            <i class="fas fa-pump-soap"></i>
            <!-- Product category title -->
            <h3>Toiletries</h3>
            <!-- Description of the product category -->
            <p>Essential baby care products</p>
            <!-- Link to the toiletries products page -->
            <a href="{% url 'toiletries:toiletries' %}" class="find-product">Find Toiletries</a>
        </div>
    </div>
</section>

<!-- Reviews and Blogs Section -->
<section id="reviews-blogs" class="reviews-blogs">
    <!-- Heading for the reviews and blogs section -->
    <h2>Reviews and Blogs</h2>
    <!-- Grid container for blog and review items -->
    <div class="blog-grid">
        <!-- Check if there are any blog and review items to display -->
        {% if blog_and_review %}
        <!-- Loop through each blog and review item -->
        {% for single_blog_and_review in blog_and_review %}
        <!-- Individual blog card -->
        <article class="blog-card">
            <!-- Container for the blog image -->
            <div class="blog-image">
                <!-- Image of the blog or review -->
                <img src="{{single_blog_and_review.image.url}}" alt="Blog/Review Image">
            </div>
            <!-- Container for the blog content -->
            <div class="blog-content">
                <!-- Title of the blog or review -->
                <h3 class="blog-title">{{single_blog_and_review.title}}</h3>
                <!-- Excerpt of the blog or review -->
                <p class="blog-excerpt">{{single_blog_and_review.excerpt}}</p>
                <!-- Link to the detailed blog or review page -->
                <a href="{% url 'homepage:detail_blog_review' single_blog_and_review.id %}" class="blog-link">Read
                    More</a>
            </div>
        </article>
        <!-- End for loop -->
        {% endfor %}
        <!-- End if condition -->
        {% endif %}
    </div>
</section>

<!-- About Section -->
<section id="about" class="about">
    <!-- Heading for the about section -->
    <h2>About BeginMama</h2>
    <!-- Description about Fastworldtec -->
    <p>Begin Your Best Mama Moments with Us.
    </p>
</section>

<!-- Contact Section -->
<section id="contact" class="contact">
    <!-- Heading for the contact section -->
    <h2>Get in Touch</h2>
    <!-- Contact form -->
    <form id="contact-form" method="POST">
        <!-- CSRF token for security -->
        {% csrf_token %}
        <!-- Input field for full name -->
        <input type="text" name="full_name" placeholder="Your Full Name" required>
        <!-- Input field for email -->
        <input type="email" name="email" placeholder="Your Email" required>
        <!-- Textarea for message -->
        <textarea name="message" placeholder="Your Message" required></textarea>
        <!-- Submit button for the form -->
        <button type="submit">Send Message</button>
    </form>
</section>

<!-- Begin footer section -->
<footer>
    <!-- Container for the footer content -->
    <div class="footer-content">

        <!-- Section for the website's name and slogan -->
        <div class="footer-section">
            <h3>BeginMama</h3>
            <p>Begin Your Best Mama Moments with Us.</p>
        </div>

        <!-- Section for quick navigation links -->
        <div class="footer-section">
            <h3>Quick Links</h3>
            <!-- List of quick navigation links -->
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#products">Products</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#reviews-blogs">Reviews & Blogs</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </div>

        <!-- Section for alternative contact methods -->
        <div class="footer-section">
            <h3>Alternative Contacts</h3>
            <!-- Container for social icons or contact icons -->
            <div class="social-icons">
                <!-- Phone contact icon -->
                <a href="tel:+1 929 566 4618"><i class="fa-solid fa-phone"></i></a>
                <!-- Email contact icon -->
                <a href="mailto:infofirstworldtec@gmail.com"><i class="fa-solid fa-envelope"></i></a>
            </div>
        </div>
    </div>

    <!-- Footer bottom section with copyright information -->
    <div class="footer-bottom">
        <p>&copy; 2024 BeginMama. All rights reserved.</p>
    </div>
</footer>

<!-- Link to the external JavaScript file navbar.js -->
<script src="{% static 'js/navbar.js' %}"></script>


<!-- Link to the JavaScript file message_form.js -->
<script src="{% static 'js/message_form.js' %}"></script>

{% endblock %}

